<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>HoughLinesLineDetector.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">rc-server</a> &gt; <a href="../index.html" class="el_bundle">rc-detect</a> &gt; <a href="index.source.html" class="el_package">org.rcdukes.detect.linedetection</a> &gt; <span class="el_source">HoughLinesLineDetector.java</span></div><h1>HoughLinesLineDetector.java</h1><pre class="source lang-java linenums">package org.rcdukes.detect.linedetection;

import java.util.Collection;
import java.util.HashSet;
import java.util.Set;

import org.opencv.core.Mat;
import org.opencv.imgproc.Imgproc;
import org.rcdukes.detectors.LineDetector;
import org.rcdukes.geometry.Line;

/**
 * Hough Lines Line Detector
 *
 */
public class HoughLinesLineDetector implements LineDetector {

<span class="nc" id="L18">  double rho = 1;</span>
<span class="nc" id="L19">  double theta = Math.PI / 180; // By choosing this value lines sloping</span>
                                // left to right will be &lt; 0 radian,
                                // while lines sloping right to left
                                // will be &gt; 0 radian.
<span class="nc" id="L23">  int threshold = 70;</span>
<span class="nc" id="L24">  double minLineLength = 20;</span>
<span class="nc" id="L25">  double maxLineGap = 10;</span>
<span class="nc" id="L26">  boolean probabilistic = true;</span>
 
  /**
   * default constructor
   */
<span class="nc" id="L31">  public HoughLinesLineDetector() {</span>
    
<span class="nc" id="L33">  }</span>
  
  /**
   * construct me
   * 
   * @param rho
   * @param theta
   * @param threshold
   * @param minLineLength
   * @param maxLineGap
   */
  public HoughLinesLineDetector(boolean probabilistic, double rho, double theta,
<span class="nc" id="L45">      int threshold, double minLineLength, double maxLineGap) {</span>
<span class="nc" id="L46">    this.probabilistic = probabilistic;</span>
<span class="nc" id="L47">    this.rho = rho;</span>
<span class="nc" id="L48">    this.theta = theta;</span>
<span class="nc" id="L49">    this.threshold = threshold;</span>
<span class="nc" id="L50">    this.minLineLength = minLineLength;</span>
<span class="nc" id="L51">    this.maxLineGap = maxLineGap;</span>
<span class="nc" id="L52">  }</span>

  @Override
  public Collection&lt;Line&gt; detect(Mat image) {
<span class="nc" id="L56">    Mat houghLinesMat=detectMat(image);</span>
    
    
<span class="nc" id="L59">    Set&lt;Line&gt; lines = new HashSet&lt;Line&gt;();</span>
<span class="nc bnc" id="L60" title="All 2 branches missed.">    for (int x = 0; x &lt; houghLinesMat.rows(); x++) {</span>
<span class="nc" id="L61">      Line line = Line.fromHough(probabilistic,image.width(),image.height(),houghLinesMat.get(x, 0));</span>
<span class="nc" id="L62">      lines.add(line);</span>
    }
<span class="nc" id="L64">    houghLinesMat.release();</span>
<span class="nc" id="L65">    return lines;</span>
  }

  /**
   * detect lines
   * 
   * @param image
   * @return a Mat with encoded lines see 
   * &lt;a href=&quot;https://docs.opencv.org/3.4/d9/db0/tutorial_hough_lines.html&quot;&gt;OpenCV tutorial hough lines&lt;/a&gt;
   */
  private Mat detectMat(Mat image) {
<span class="nc" id="L76">    Mat lineMat = new Mat();</span>
    // see 
<span class="nc bnc" id="L78" title="All 2 branches missed.">    if (probabilistic) {</span>
<span class="nc" id="L79">      Imgproc.HoughLinesP(image, lineMat, rho, theta, threshold, minLineLength,</span>
          maxLineGap);
    } else {
<span class="nc" id="L82">      Imgproc.HoughLines(image, lineMat, rho, theta, threshold);</span>
    }
<span class="nc" id="L84">    return lineMat;</span>
  }

  public double getRho() {
<span class="nc" id="L88">    return rho;</span>
  }

  public void setRho(double rho) {
<span class="nc" id="L92">    this.rho = rho;</span>
<span class="nc" id="L93">  }</span>

  public double getTheta() {
<span class="nc" id="L96">    return theta;</span>
  }

  public void setTheta(double theta) {
<span class="nc" id="L100">    this.theta = theta;</span>
<span class="nc" id="L101">  }</span>

  public int getThreshold() {
<span class="nc" id="L104">    return threshold;</span>
  }

  public void setThreshold(int threshold) {
<span class="nc" id="L108">    this.threshold = threshold;</span>
<span class="nc" id="L109">  }</span>

  public double getMinLineLength() {
<span class="nc" id="L112">    return minLineLength;</span>
  }

  public void setMinLineLength(double minLineLength) {
<span class="nc" id="L116">    this.minLineLength = minLineLength;</span>
<span class="nc" id="L117">  }</span>

  public double getMaxLineGap() {
<span class="nc" id="L120">    return maxLineGap;</span>
  }

  public void setMaxLineGap(double maxLineGap) {
<span class="nc" id="L124">    this.maxLineGap = maxLineGap;</span>
<span class="nc" id="L125">  }</span>

  /**
   * @return the probabilistic
   */
  public boolean isProbabilistic() {
<span class="nc" id="L131">    return probabilistic;</span>
  }

  /**
   * @param probabilistic
   *          the probabilistic to set
   */
  public void setProbabilistic(boolean probabilistic) {
<span class="nc" id="L139">    this.probabilistic = probabilistic;</span>
<span class="nc" id="L140">  }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.4.201905082037</span></div></body></html>